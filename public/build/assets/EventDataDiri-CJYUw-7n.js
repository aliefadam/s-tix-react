import{j as e,r as w,q as I,W as F}from"./app-YfqX9fOd.js";import{B}from"./BreadCrumb-3bK-c6DF.js";import{f as M,E as A}from"./EventDetailPanel-B47TK33W.js";import{U as L}from"./UserLayout-DOp3J72y.js";import{g as v}from"./getDatePart-HgEJ48wy.js";import{g as D}from"./getDistance-Dm5tcyCK.js";import{N as S}from"./notification-D8nuFN0y.js";import{t as H}from"./timeToSeconds-hLgWVabV.js";function h({type:l,id:s,name:t,value:r,handleChange:m,title:a,userType:c,index:d=null,ticketID:u=null,error:i=null}){const o=n=>{c==="pembeli"?m(n,"data_pembeli"):m(n,"data_pengunjung",d,u)},x=()=>i?"border border-red-500 focus:border-red-500 focus:ring-0":"border border-gray-300 focus:ring-teal-500 focus:border-teal-500";return e.jsxs("div",{children:[e.jsx("label",{htmlFor:s,className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:a}),e.jsx("input",{type:l,id:s,name:t,value:r,onChange:n=>o(n),className:`${x()} text-gray-900 text-sm rounded-lg block w-full p-2.5`}),l==="email"&&s==="email"&&e.jsx("span",{className:"text-xs poppins-medium text-teal-700 mt-2 block",children:"Email ini digunakan untuk mengirim E-Ticket"}),i&&e.jsx("span",{className:"text-sm poppins-medium text-red-600 mt-2 block",children:i})]})}function T({date:l,month:s,year:t,handleChange:r,userType:m,index:a=null,ticketID:c=null,error:d={date:null,month:null,year:null}}){const u=n=>{m==="pembeli"?r(n,"data_pembeli"):r(n,"data_pengunjung",a,c)},i=()=>d.date?"border border-red-500 focus:border-red-500 focus:ring-0":"border border-gray-300 focus:ring-teal-500 focus:border-teal-500",o=()=>d.month?"border border-red-500 focus:border-red-500 focus:ring-0":"border border-gray-300 focus:ring-teal-500 focus:border-teal-500",x=()=>d.year?"border border-red-500 focus:border-red-500 focus:ring-0":"border border-gray-300 focus:ring-teal-500 focus:border-teal-500";return e.jsxs("div",{children:[e.jsx("label",{htmlFor:"date",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Tanggal Lahir"}),e.jsxs("div",{className:"grid grid-cols-3 gap-5",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("select",{id:"date",name:"date",value:l,onChange:n=>u(n),className:`bg-gray-50 text-gray-900 text-sm rounded-lg  block w-full p-2.5 ${i()}`,children:[e.jsx("option",{value:"",children:"Tanggal"}),Array.from({length:31},(n,p)=>e.jsx("option",{value:String(p+1).padStart(2,"0"),children:String(p+1).padStart(2,"0")},p))]}),d.date&&e.jsx("p",{className:"text-red-600 text-sm",children:d.date})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("select",{id:"month",name:"month",value:s,onChange:n=>u(n),className:`h-fit bg-gray-50 text-gray-900 text-sm rounded-lg  block w-full p-2.5 ${o()}`,children:[e.jsx("option",{value:"",children:"Bulan"}),Array.from({length:12},(n,p)=>e.jsx("option",{value:String(p+1).padStart(2,"0"),children:String(p+1).padStart(2,"0")},p))]}),d.month&&e.jsx("p",{className:"text-red-600 text-sm",children:d.month})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("select",{id:"year",name:"year",value:t,onChange:n=>u(n),className:`h-fit bg-gray-50 text-gray-900 text-sm rounded-lg  block w-full p-2.5 ${x()}`,children:[e.jsx("option",{value:"",children:"Tahun"}),Array.from({length:100},(n,p)=>e.jsx("option",{value:String(2024-p),children:2024-p},p))]}),d.year&&e.jsx("p",{className:"text-red-600 text-sm",children:d.year})]})]})]})}function E({gender:l,handleChange:s,index:t=null,ticketID:r=null,userType:m,name:a,idFemale:c,idMale:d,error:u=null}){const i=n=>{m==="pembeli"?s(n,"data_pembeli"):s(n,"data_pengunjung",t,r)},o=()=>u?"border border-red-500":"border border-gray-300",x=n=>l===n;return e.jsxs("div",{children:[e.jsx("label",{htmlFor:"gender",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Jenis Kelamin"}),e.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[e.jsxs("div",{className:`flex items-center ps-4 rounded ${o()}`,children:[e.jsx("input",{id:d,type:"radio",value:"Laki-laki",name:a,checked:x("Laki-laki"),onChange:n=>i(n),className:"w-4 h-4 text-teal-600 bg-gray-100 border-gray-300 focus:ring-teal-500 dark:focus:ring-teal-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),e.jsx("label",{htmlFor:d,className:"w-full py-4 ms-2 text-sm font-medium text-gray-900 dark:text-gray-300",children:"Laki-laki"})]}),e.jsxs("div",{className:`flex items-center ps-4 rounded ${o()}`,children:[e.jsx("input",{id:c,type:"radio",value:"Perempuan",name:a,checked:x("Perempuan"),onChange:n=>i(n),className:"w-4 h-4 text-teal-600 bg-gray-100 border-gray-300 focus:ring-teal-500 dark:focus:ring-teal-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),e.jsx("label",{htmlFor:c,className:"w-full py-4 ms-2 text-sm font-medium text-gray-900 dark:text-gray-300",children:"Perempuan"})]})]}),u&&e.jsx("span",{className:"text-sm text-red-600 block mt-2",children:u})]})}function P({identity_type:l,identity_number:s,handleChange:t,userType:r,index:m=null,ticketID:a=null,error:c={identity_type:null,identity_number:null}}){const d=o=>{r==="pembeli"?t(o,"data_pembeli"):t(o,"data_pengunjung",m,a)},u=()=>c.identity_type?"border border-red-500 focus:border-red-500 focus:ring-0":"border border-gray-300 focus:ring-teal-500 focus:border-teal-500",i=()=>c.identity_number?"border border-red-500 focus:border-red-500 focus:ring-0":"border border-gray-300 focus:ring-teal-500 focus:border-teal-500";return e.jsxs("div",{children:[e.jsx("label",{htmlFor:"identity-type",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Nomor Identitas"}),e.jsxs("div",{className:"flex mb-2",children:[e.jsxs("select",{id:"identity-type",name:"identity_type",value:l,onChange:o=>d(o),className:`poppins-medium bg-gray-100 rounded-s-lg text-gray-900 text-sm block p-2.5 ${u()}`,children:[e.jsx("option",{value:"",children:"Pilih Identitas"}),e.jsx("option",{value:"KTP",children:"KTP"}),e.jsx("option",{value:"SIM",children:"SIM"}),e.jsx("option",{value:"PASSPORT",children:"Passport"})]}),e.jsx("input",{type:"number",id:"identity-number",name:"identity_number",value:s,onChange:o=>d(o),className:`poppins-medium bg-gray-50 w-full text-gray-900 text-sm block p-2.5 ${i()}`})]}),c.identity_number&&e.jsx("p",{className:"text-sm text-red-600",children:c.identity_number}),c.identity_type&&e.jsx("p",{className:"text-sm text-red-600",children:c.identity_type})]})}function K({data_pembeli:l,handleChange:s,errors:t}){return e.jsxs("div",{className:"border border-teal-700 text-white rounded-md shadow-md overflow-hidden",children:[e.jsx("div",{className:"p-5 bg-gradient-to-r from-teal-400 to-teal-500",children:e.jsx("span",{className:"text-center block",children:"Detail Pembeli"})}),e.jsxs("div",{className:"p-5 flex flex-col gap-4",children:[e.jsx(h,{id:"email",type:"email",name:"email",value:l.email,title:"Email",handleChange:s,userType:"pembeli",error:t["data_pembeli.email"]}),e.jsx(h,{id:"name",type:"text",name:"name",value:l.name,title:"Nama",handleChange:s,userType:"pembeli",error:t["data_pembeli.name"]}),e.jsx(T,{date:l.date,month:l.month,year:l.year,handleChange:s,userType:"pembeli",error:{date:t["data_pembeli.date"],month:t["data_pembeli.month"],year:t["data_pembeli.year"]}}),e.jsx(E,{gender:l.gender,handleChange:s,name:"gender",userType:"pembeli",idFemale:"gender-female",idMale:"gender-male",error:t["data_pembeli.gender"]}),e.jsx(P,{identity_type:l.identity_type,identity_number:l.identity_number,handleChange:s,userType:"pembeli",error:{identity_type:t["data_pembeli.identity_type"],identity_number:t["data_pembeli.identity_number"]}})]})]})}function W({ticket:l}){return e.jsxs("div",{className:"bg-gray-50 p-4 border border-teal-700 flex justify-between items-center rounded-md shadow-md",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h1",{className:"text-gray-500 text-sm poppins-medium",children:"Kategori Tiket"}),e.jsx("span",{className:"text-black poppins-medium mt-[3px]",children:l.name})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h1",{className:"text-gray-500 text-sm poppins-medium text-right",children:"Harga"}),e.jsx("span",{className:"text-black poppins-medium mt-[3px]",children:M(l.price)})]})]})}function Z({index:l,ticketID:s,samakanDataPembeli:t}){return e.jsx("span",{className:"text-center block",children:e.jsxs("label",{className:"inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",value:"",className:"sr-only peer samakan-data-pembeli",name:`samakan-data-pembeli[${l}]`,onChange:r=>t(r,l,s)}),e.jsx("div",{className:"shadow-md relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-teal-300 dark:peer-focus:ring-teal-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:w-5 after:h-5 after:transition-all dark:border-gray-600 peer-checked:bg-teal-600"}),e.jsx("span",{className:"ms-3 text-sm font-medium text-white dark:text-gray-300",children:"Samakan dengan data pembeli"})]})})}function G({tickets:l,samakanDataPembeli:s,data_pengunjung:t,handleChange:r}){return e.jsx(e.Fragment,{children:l.map((m,a)=>{var c,d,u,i,o,x,n,p;return e.jsxs("div",{className:"border border-teal-700 text-white rounded-md shadow-md overflow-hidden pengunjung",children:[e.jsxs("div",{className:"p-5 flex justify-between items-center bg-gradient-to-r from-teal-400 to-teal-500",children:[e.jsxs("span",{className:"text-center block",children:["Detail Pengunjung ",a+1]}),e.jsx(Z,{index:a,ticketID:m.id,samakanDataPembeli:s})]}),e.jsxs("div",{className:"p-5 flex flex-col gap-4",children:[e.jsx(W,{ticket:m}),e.jsx(h,{id:`email-pengunjung-${a}`,type:"email",name:"email",title:"Email",handleChange:r,value:(c=t[a])==null?void 0:c.email,userType:"pengunjung",index:a,ticketID:m.id}),e.jsx(h,{id:`name-pengunjung-${a}`,type:"text",name:"name",title:"Nama",handleChange:r,value:(d=t[a])==null?void 0:d.name,index:a,ticketID:m.id}),e.jsx(T,{date:(u=t[a])==null?void 0:u.date,month:(i=t[a])==null?void 0:i.month,year:(o=t[a])==null?void 0:o.year,handleChange:r,index:a,ticketID:m.id}),e.jsx(E,{gender:(x=t[a])==null?void 0:x[`gender-${a}`],handleChange:r,userType:"pengunjung",index:a,ticketID:m.id,data_pengunjung:t,name:`gender-${a}`,idMale:`gender-male-${a}`,idFemale:`gender-female-${a}`}),e.jsx(P,{identity_type:(n=t[a])==null?void 0:n.identity_type,identity_number:(p=t[a])==null?void 0:p.identity_number,handleChange:r,userType:"pengunjung",index:a,ticketID:m.id})]})]},a)})})}function X({title:l,profile:s,event:t,data_ticket:r}){const m={before:[{url:route("home"),name:"Beranda"},{url:route("event",t.slug),name:t.name},{url:route("event.tickets",t.slug),name:"Pilih Tiket"}],active:l},[a,c]=w.useState(D({expiration_date:r.expiration_time})),d=()=>{const b=setInterval(()=>{const g=D({expiration_date:r.expiration_time});H(g)<0?(S({title:"Waktu pembelian telah habis",text:"Silahkan lakukan pembelian ulang",icon:"warning"}).then(y=>{y.isConfirmed&&(window.location.href=route("event.tickets",t.slug))}),clearInterval(b)):c(g)},1e3);return()=>clearInterval(b)},{notification:u}=I().props;w.useEffect(()=>{d(),u&&S(u)},[r.expiration_time,u]);const{data:i,setData:o,post:x,processing:n,errors:p}=F({data_pengunjung:[],data_pembeli:{email:s.email,name:s.name,date:v(s.date_of_birth,"day"),month:v(s.date_of_birth,"month"),year:v(s.date_of_birth,"year"),gender:s.gender,identity_type:s.identity_type,identity_number:s.identity_number},sub_total:r.sub_total,tax:r.tax,tax_amount:r.tax_amount,total:r.total}),k=(b,g,y=null,f=null)=>{const N=b.target.name,_=b.target.value;if(g=="data_pembeli")o("data_pembeli",{...i.data_pembeli,[N]:_});else{const j=[...i.data_pengunjung];j[y]={...j[y],[`ticket_id-${y}`]:f,[N]:_},o("data_pengunjung",j)}},$=(b,g,y)=>{const f=[...i.data_pengunjung];b.target.checked?f[g]={...f[g],[`ticket_id-${g}`]:y,email:i.data_pembeli.email,name:i.data_pembeli.name,date:i.data_pembeli.date,month:i.data_pembeli.month,year:i.data_pembeli.year,[`gender-${g}`]:i.data_pembeli.gender,identity_type:i.data_pembeli.identity_type,identity_number:i.data_pembeli.identity_number}:f[g]={...f[g],[`ticket_id-${g}`]:null,email:"",name:"",date:"",month:"",year:"",[`gender-${g}`]:"",identity_type:"",identity_number:""},o("data_pengunjung",f)},C=async b=>{b.preventDefault(),x(route("event.save-data-diri",t.slug))};return e.jsxs(L,{title:"Detail Event",children:[e.jsx(B,{breadCrumbData:m}),e.jsx("form",{action:"",onSubmit:C,children:e.jsxs("div",{className:"mt-8 grid grid-cols-12 gap-8 min-h-[80vh]",children:[e.jsxs("div",{className:"col-span-8 h-fit flex flex-col gap-5",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 text-sm text-yellow-800 border border-yellow-300 rounded-lg bg-yellow-50 dark:bg-gray-800 dark:text-yellow-300 dark:border-yellow-800",role:"alert",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"flex-shrink-0 inline w-4 h-4 me-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"})}),e.jsx("span",{className:"sr-only",children:"Info"}),e.jsx("div",{className:"",children:e.jsx("span",{className:"font-medium",children:"Batas Waktu Pengisian Data"})})]}),e.jsx("div",{className:"",children:e.jsx("span",{className:"poppins-semibold",children:a})})]}),e.jsx(K,{data_pembeli:i.data_pembeli,handleChange:k,errors:p}),e.jsx(G,{data_pengunjung:i.data_pengunjung,handleChange:k,tickets:r.tickets,samakanDataPembeli:$})]}),e.jsx("div",{className:"col-span-4 h-fit sticky top-[110px] bg-white border border-teal-700 shadow-md rounded-md",children:e.jsx(A,{processing:n,event:t,subTotal:r.sub_total,ticketCount:r.tickets.length,tax:r.tax,taxAmount:r.tax_amount,total:r.total})})]})})]})}export{X as default};
